---
title: "Introduction to ProtE"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to ProtE}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

One function to analyze them all! The Proteomics Eye (ProtE) establishes an intuitive framework for the univariate analysis of label-free proteomics data. By compiling all necessary data wrangling and processing steps into the same function, ProtE automates all pairwise statistical comparisons for a given categorical variable, returning to the user performance quality metrics, measures to control for Type-I or Type-II errors, and publication-ready visualizations. 

ProtE is currently compatible with data generated by MaxQuant, DIA-NN and Proteome Discoverer.

# How to install: 

Because some package-dependencies (limma, UniProt.ws, missRanger) are inside the BioConductor repository, if they have not already been installed in your environment, use the reporting code to install the package:
```{r, eval=FALSE}
install.packages("BiocManager")
options(repos = BiocManager::repositories())
devtools::install_github("theomargel/ProtE")
```

Then load its library with:

```{r setup}
library(ProtE)
```

ProtE features 4 functions, each one tailored for a specific use case.

1.  ```maximum_quantum()``` accepts as input the MaxQuant generated file protein_pg.xlsx
2.  ```dianno()``` accepts as input the DIA-NN (or the FragPipe - DIANN) output file protein_pg.xlsx
3.  ```pd_single()``` accepts as input the Proteome Discoverer output file that contains all sample protein intensities/abundances in one table
4.  ```pd_multi()``` accepts as input separate Proteome Discoverer protein intensity files (Ask Mirka for the naming of the PD settings that determine this)

# How to use functions 1-3
Functions 1-3 contain the same parameters, but differ in the column names of the input data they expect to read. The input file is parsed in the parameter.
Assuming a MaxQuant quantification has been performed, the file protein_pg.xlsx can be fed to ProtE with the following function:
```{r, eval=FALSE}
maximum_quantum <- (excel_file,
                    group_names,
                    samples_per_group,
                    imputation = FALSE,
                    global_filtering = TRUE,
                    sample_relationship = "Independent",
                    threshold_value = 50,
                    normalization = FALSE,
                    parametric= FALSE,
                    significance = "pV")
```
 using the file path.

Insert the file path of the protein_pg.xlsx in the ```excel_file``` parameter. To copy paste the file path in Windows, firstly locate the desired file inside your folders. Hold Shift and right-click the file, then select "Copy as Path" from the context menu. Go to RStudio and click Ctrl+V to paste the path to the file

Functions 1-3 expect the input samples (columns) to be sorted consecutively based on the categorical variable that are going to be analyzed for (example of an experiment with a categorical variable having 3 groups: first columns = Group 1, middle columns = Group 2, last columns = Group 3). The user then has to specify the number of samples for each group in the paramater:  





1.	Normalization of proteomic intensity values.

2.	Filtering based on the percentage of missing values.

3.	Imputation of missing data to ensure robust downstream analysis.

Once the processing is complete, the package performs statistical analysis to identify significant differences between experimental groups. The results are automatically exported as Excel files, and a range of visualizations is generated to facilitate interpretation. These include:

•	Principal Component Analysis (PCA) plots for dimensionality reduction and group comparison.

•	Heatmap highlighting significant proteins.

•	Protein rank-abundance scatterplots.

•	Boxplots and violin plots to display data distribution and variability across groups.

The package streamlines the analysis of proteomics data, providing both detailed results and high-quality visualizations in a quick and reproducible manner.



## Output Directory

The results from each function are saved in a folder named **MS_Analysis**, which is created inside the last directory of the provided Excel file(s).

